import { StatementData } from '@novasamatech/statement-store';
import { describe, it } from 'vitest';

import { ChatMessage } from './message.js';
describe('codec', () => {
  it('should work', () => {
    const hex =
      '0x009035343538353744302d383537432d344245462d394231302d3442304634464442303241452045019035353545393843462d333139302d343041362d414443462d333333453641344538363346268500ae9b0100000001801598b984e4b3783b648afd092cd1b1a85284d6eb4861c2dcdecfaae997c80c3501bc9032373045433236332d344243422d344332332d413636372d4537363330304444413841372d8500ae9b010000000345019045463441433036372d344432362d343844342d384443412d423242463132424237313835398500ae9b0100000001801598b984e4b3783b648afd092cd1b1a85284d6eb4861c2dcdecfaae997c80c3501d49033343933393744332d354341362d343039422d393831462d344131394634333541454137e6d000ae9b0100000000144269626970d09044434535413445332d304142432d343238382d384541422d3045343636443046334139450d7801ae9b01000000001054657374cc9035353930303044382d343744312d343444432d384433362d423831443433394632423135939502ae9b01000000000c466464cc9044384342384241312d423942342d343137392d393846442d313243313336414436433131f40a03ae9b01000000000c486868cc9039323230314430382d373143412d344338322d383836422d3736363245303938444139333e0d07ae9b01000000000c486473';

    const a = StatementData.dec(hex);

    if (a.tag === 'request') {
      a.value.data.forEach(payload => {
        const message = ChatMessage.dec(payload);
        console.log(message);
        console.log(JSON.stringify(message.versioned.value, null, 2));
      });
    }
  });
});
